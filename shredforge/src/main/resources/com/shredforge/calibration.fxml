<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.Rectangle?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.control.Tooltip?>

<VBox alignment="CENTER" spacing="25.0" xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.shredforge.ui.CalibrationController">
    <padding>
        <Insets bottom="30.0" left="40.0" right="40.0" top="30.0" />
    </padding>

    <!-- Title -->
    <Label text="Guitar Calibration" textAlignment="CENTER">
        <font>
            <Font name="System Bold" size="32.0" />
        </font>
    </Label>

    <!-- Instruction Panel -->
    <VBox alignment="CENTER" spacing="15.0" style="-fx-background-color: #f0f0f0; -fx-padding: 20; -fx-background-radius: 10;">
        <Label fx:id="instructionLabel" text="Click Start to begin calibration" textAlignment="CENTER">
            <font>
                <Font name="System Bold" size="20.0" />
            </font>
        </Label>

        <!-- Visual Tuner Display -->
        <VBox alignment="CENTER" spacing="10.0">
            <Label fx:id="detectedFrequencyLabel" text="--.- Hz">
                <font>
                    <Font name="Monospaced" size="24.0" />
                </font>
            </Label>

            <Label fx:id="tuningIndicator" text="â™ª">
                <font>
                    <Font size="36.0" />
                </font>
            </Label>
        </VBox>
    </VBox>

    <!-- Progress Section -->
    <VBox alignment="CENTER" spacing="10.0" maxWidth="400.0">
        <HBox alignment="CENTER" spacing="10.0">
            <Label text="Progress:" />
            <Label fx:id="progressLabel" text="String 0 of 6" />
        </HBox>

        <ProgressBar fx:id="progressBar" progress="0.0" prefWidth="300.0" />
    </VBox>

    <!-- Audio Level Meter -->
    <HBox alignment="CENTER" spacing="10.0">
        <Label text="Audio Level:" />
        <StackPane style="-fx-border-color: gray; -fx-border-width: 1;">
            <Rectangle fx:id="audioLevelMeter" height="20.0" width="50.0" fill="green" />
        </StackPane>
    </HBox>

    <!-- Control Buttons -->
    <HBox alignment="CENTER" spacing="15.0">
        <Button fx:id="startButton" text="Start Calibration" onAction="#handleStart" minWidth="140.0" style="-fx-background-color: #4CAF50; -fx-text-fill: white;">
            <font>
                <Font size="14.0" />
            </font>
            <tooltip>
                <Tooltip text="Begin guitar calibration process" />
            </tooltip>
        </Button>

        <Button fx:id="retryButton" text="Retry" onAction="#handleRetry" minWidth="80.0">
            <font>
                <Font size="14.0" />
            </font>
            <tooltip>
                <Tooltip text="Retry calibrating the current string" />
            </tooltip>
        </Button>

        <Button fx:id="nextButton" text="Next String" onAction="#handleNext" minWidth="100.0" style="-fx-background-color: #2196F3; -fx-text-fill: white;">
            <font>
                <Font size="14.0" />
            </font>
            <tooltip>
                <Tooltip text="Move to the next guitar string" />
            </tooltip>
        </Button>
    </HBox>

    <HBox alignment="CENTER" spacing="15.0">
        <Button fx:id="saveExitButton" text="Save &amp; Exit" onAction="#handleSaveExit" minWidth="120.0" style="-fx-background-color: #4CAF50; -fx-text-fill: white;">
            <font>
                <Font size="14.0" />
            </font>
            <tooltip>
                <Tooltip text="Save calibration data and return to main menu" />
            </tooltip>
        </Button>

        <Button text="Cancel" onAction="#handleCancel" minWidth="80.0">
            <font>
                <Font size="14.0" />
            </font>
            <tooltip>
                <Tooltip text="Cancel calibration without saving" />
            </tooltip>
        </Button>
    </HBox>

    <!-- Status Label -->
    <Label fx:id="statusLabel" text="Ready to calibrate">
        <font>
            <Font size="12.0" />
        </font>
    </Label>

    <!-- Instructions -->
    <VBox alignment="CENTER" spacing="5.0" maxWidth="500.0">
        <Label text="Calibration Instructions:" style="-fx-font-weight: bold;" />
        <Label text="1. Connect your electric guitar to your audio input" wrapText="true" textAlignment="CENTER" />
        <Label text="2. Click Start and play each open string when prompted" wrapText="true" textAlignment="CENTER" />
        <Label text="3. Hold each note for a few seconds until it calibrates" wrapText="true" textAlignment="CENTER" />
        <Label text="4. Click Save &amp; Exit when complete" wrapText="true" textAlignment="CENTER" />
    </VBox>
</VBox>
